<!-- include libraries(jQuery, bootstrap) -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<!-- include summernote css/js -->
<link href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote.min.js"></script>

<%= form_with model: @post, url: url, locale: true do |f| %>
  <div>
    <%= f.label :user_id, '작성자'%>
    <div><%= f.text_field :user_id %></div>
  </div>
  <div>
    <%= f.label :title, '제목'%>
    <div><%= f.text_field :title %></div>
  </div>

  <div>
    <script>
        // function image_upload(file, onSuccess, error) {
        //     var upload_path = '/upload/image';
        //     var upload_http_method = 'post';
        //
        //     var call = $.ajax(image_upload_request_param(file));
        //     call.fail(error || console.warn);
        //
        //     function image_upload_request_param(file) {
        //         console.log(file);
        //         var formData = new FormData();
        //         console.log(formData);
        //         formData.append('image', file);
        //         console.log(formData);
        //         return {
        //             url: upload_path,
        //             type: upload_http_method,
        //             processData: false,  // file전송시 필수
        //             contentType: false,  // file전송시 필수
        //             data: formData
        //         }
        //     }
        //
        //     if (onSuccess) {
        //         call.success(onSuccess);
        //     } else {
        //         return call;
        //     }
        // }
        //
        // function image_uploaded_callback(note_context) {
        //     return function(data) {
        //         console.log(data);
        //         var image_node = document.createElement('img');
        //         image_node.src = data.img_url;
        //         note_context.summernote('insertNode', image_node);
        //     }
        // }

        $(document).ready(function() {
            var note = $('#post_content');
            note.summernote({
                placeholder: '내용을 입력해주세요',
                tabsize: 2,
                height: 450,
                lang: 'ko-KR',
                // callbacks: {
                //     onImageUpload: function(files) {
                //         for (var i = 0; i < files.length; i++) {
                //             console.log(files[i], note);
                //             image_upload(files[i], image_uploaded_callback(note))
                //         }
                //     }
                // }
            });
        });
    </script>
    <%= f.label :CONT, '내용', class: 'col-sm-2 col-form-label' %>
    <div>
      <textarea name="post[content]" id="post_content" rows="10" class="form-control"></textarea>
    </div>
  </div>
  <div>
    <%= f.submit '저장' %>
  </div>

<% end %>

